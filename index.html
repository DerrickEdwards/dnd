<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Drag And Drop Editor</title>

    <!-- add bootstrap stuff here -->

    <!-- jqeury should be downloaded from the JQuery UI Download Builder   -->
    <!--  and the contents placed in a "jquery" folder at the project root -->
    <!-- http://jqueryui.com/download/ -->
    <link rel="stylesheet" href="jquery/jquery-ui.min.css">
    <script src="jquery/external/jquery/jquery.js"></script>
    <script src="jquery/jquery-ui.min.js"></script>

    <!-- Local project specific style sheet and script file -->
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>

    <!-- immediate script -->
    <script>
      $( function() { 

        $( ".buildable" ).draggable({
            handle: ".componentTitle",
            helper: "clone",      // display a clone of the original item while it is being dragged.
            grid: [ 20, 20 ],     // snap to a 20x20px grid
            opacity: 0.7,         // set opacity of cloned helper while it is being dragged
            revert: "invalid"     // return to original position of not successfully dropped
          });

        $( ".buildable" ).resizable({
            grid: [ 20, 20 ]      // snap to a 20x20px grid
          });

        // $( "div" ).disableSelection();
        // $( ".layout-row" ).draggable( {
        //     stop : function( event, ui ){ } // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< START HERE
        // })

        $( "#workspace" ).droppable( {
            accept: ".layout-row, .layout-column",  // only accept droppable items with these classes, other selectors can be added
            drop:   handleDroppedItem
          } ) // end .droppable

          // >>>>>>>>>>>>>>>>>>>>>>>>>> leave these turned off until the redraggable issue is fixed
        // $( ".layout-row" ).droppable( {
        //     accept: ".outlet, .nav, .layout-row, .layout-column",  // only accept droppable items with the class ".outlet", other selectors can be added
        //     drop:   function(event, ui){ 
        //       console.log( "layout-row dropped" );
        //       cloneDroppedItem( event, ui );                         // call the "drop" function and pass the event and ui parameters           
        //     } 
        //   } ) // end .droppable

        // $( ".layout-column" ).droppable( {
        //     accept: ".outlet, .nav, .layout-row, .layout-column",  // only accept droppable items with the class ".outlet", other selectors can be added
        //     drop:   function(event, ui){ cloneDroppedItem( event, ui )} // call the "drop" function and pass the event and ui parameters
        //   } ) // end .droppable


      });  // end iff script functions
        

      //===============================================
      
      function removeItem( itemId ){
        console.log( "removeItem() called: " + itemId );
        $( "#" + itemId ).remove();  // remove the DOM element with the given id
      } // end removeItem()

    </script>

  </head>
  <body>
  <h2>Drag and Drop Editor Demo</h2>

  <div id="componentMenu"> 
    <div class="componentMenuTitle">Components</div>

    <div class="nav buildable draggable resizable" data-item-type="nav">
      <div class="componentTitle">Nav</div>
      <div class="icon-remove invisible" onclick="removeItem($(this).parent().attr('id'))">X</div>
    </div>

    <div class="outlet buildable draggable resizable" data-item-type="outlet">
      <div class="componentTitle">Outlet</div>
      <div class="icon-remove invisible" onclick="removeItem($(this).parent().attr('id'))">X</div>
    </div>


    <div class="layout-row buildable" data-item-type="layout-row" ><div class="componentTitle">Row</div><div class="icon-remove">X</div></div>
    <div class="layout-column buildable" data-item-type="layout-column" ><div class="componentTitle">Column</div><div class="icon-remove">X</div></div>
    <div class="form buildable"   data-item-type="form"><div class="componentTitle">Form</div><div class="icon-remove">X</div></div>
    <div class="field buildable"  data-item-type="field"><div class="componentTitle">Field</div><div class="icon-remove">X</div></div>
    <div class="layout buildable" data-item-type="layout"><div class="componentTitle">Layout</div><div class="icon-remove">X</div></div>
    <div class="view buildable"   data-item-type="view"><div class="componentTitle">View</div><div class="icon-remove">X</div></div>
    <div class="image buildable"  data-item-type="image"><div class="componentTitle">Image</div><div class="icon-remove">X</div></div>
    <div class="text buildable"   data-item-type="text"><div class="componentTitle">Text</div><div class="icon-remove">X</div></div>

  </div>

  <!-- Droppable Container -->
  <div id="workspace" class="droppable">
    <div class="componentMenuTitle">Workspace</div>
    <div class="layout-row buildable draggable resizable" data-item-type="layout-row" ><div class="componentTitle">Row</div><div class="icon-remove">X</div></div>
  </div>

  </body>
</html>
